<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>For Evan ‚Äî Happy Valentine's Day</title>
<style>
  :root{--accent:#d63384;--shadow:rgba(10,10,20,0.12);}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:#2b2730}
  body{display:flex;align-items:center;justify-content:center;
    background: linear-gradient(180deg,#fff6f9,#fff0f6);overflow:hidden;}
  .stage{width:min(920px,94vw);height:min(720px,84vh);
    background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,248,250,0.98));
    border-radius:18px;box-shadow:0 18px 40px var(--shadow);padding:28px;display:grid;
    grid-template-columns:1fr 360px;gap:18px;align-items:center;overflow:visible;}
  .canvas{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;}
  svg.floral{width:100%;height:100%;max-height:640px;overflow:visible;}
  .panel{padding:18px;display:flex;flex-direction:column;gap:12px}
  h1{margin:0;font-size:22px;color:#3e2730} .recipient{font-weight:700;color:var(--accent);font-size:28px}
  p.lead{margin:0;color:#5b5260;font-size:14px}
  .controls{margin-top:auto;display:flex;gap:8px}
  .btn{background:linear-gradient(180deg,#fff,#ffeef6);border:1px solid rgba(214,51,132,0.12);
    padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
  .btn.secondary{background:transparent;border:1px solid rgba(0,0,0,0.06)}
  /* animations & shapes */
  .stem{stroke:#2b6b3a;stroke-width:3.5;fill:none;stroke-linecap:round;transform-box:fill-box;transform-origin:center}
  .petal{transform-box:fill-box;transform-origin:center;filter:drop-shadow(0 4px 10px rgba(0,0,0,0.06))}
  .center{filter:drop-shadow(0 4px 6px rgba(0,0,0,0.06))}
  .petal{animation:petalBloom .9s cubic-bezier(.2,.9,.3,1) both}
  .flowerGroup{animation:flowerFloat 6.2s ease-in-out infinite}
  @keyframes petalBloom{0%{transform:scale(.15) translateY(18px);opacity:0}70%{transform:scale(1.06) translateY(-6px);opacity:1}100%{transform:scale(1) translateY(0)}}
  @keyframes flowerFloat{0%{transform:translateY(0)}40%{transform:translateY(-6px)}80%{transform:translateY(0)}}
  .hearts-container{position:absolute;inset:0;pointer-events:none}
  .heart{position:absolute;width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:20px;opacity:0;animation:heartRise 1.8s cubic-bezier(.2,.9,.3,1) forwards}
  @keyframes heartRise{0%{transform:translateY(0) scale(.8);opacity:0}20%{opacity:1;transform:translateY(-10px) scale(1.05)}60%{transform:translateY(-80px) scale(.95);opacity:.9}100%{transform:translateY(-160px) scale(.8);opacity:0}}
  .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(20,8,20,0.18), rgba(20,8,20,0.36));opacity:0;pointer-events:none;transition:opacity .28s;z-index:60}
  .overlay.show{opacity:1;pointer-events:all}
  .card{width:min(720px,92vw);background:#fff;border-radius:14px;padding:28px;text-align:center;box-shadow:0 24px 60px rgba(10,10,20,0.28)}
  .closeBtn{margin-top:18px;background:var(--accent);color:white;border:none;padding:10px 16px;border-radius:10px;cursor:pointer;font-weight:600}
  @media (max-width:960px){.stage{grid-template-columns:1fr;grid-auto-rows:1fr;height:94vh;padding:16px}}
</style>
</head>
<body>
<div class="stage">
  <div class="canvas">
    <!-- SVG with static fallback flowers included (guaranteed visible) -->
    <svg class="floral" viewBox="0 0 1000 700" id="floralSVG" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <radialGradient id="petalG1" cx="30%" cy="30%"><stop offset="0%" stop-color="#ffb6c9"/><stop offset="60%" stop-color="#ff6b8d"/><stop offset="100%" stop-color="#d64b6d"/></radialGradient>
        <radialGradient id="petalG2" cx="30%" cy="30%"><stop offset="0%" stop-color="#ffd9c8"/><stop offset="60%" stop-color="#ff8aa3"/><stop offset="100%" stop-color="#e0667f"/></radialGradient>
        <radialGradient id="centerG" cx="40%" cy="40%"><stop offset="0%" stop-color="#fff9d6"/><stop offset="100%" stop-color="#ffd166"/></radialGradient>
        <linearGradient id="vaseGrad" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stop-color="#ffffff" stop-opacity="0.95"/><stop offset="100%" stop-color="#ffe6ee" stop-opacity="1"/></linearGradient>
      </defs>

      <!-- vase -->
      <g transform="translate(500,520)" class="vase">
        <ellipse cx="0" cy="36" rx="200" ry="36" fill="rgba(0,0,0,0.06)"/>
        <path d="M-140 10 C-100 140 100 140 140 10 L120 240 C60 280 -60 280 -120 240 Z" fill="url(#vaseGrad)" />
      </g>

      <!-- STATIC flowers (fallback) -->
      <g id="staticFlowers">
        <!-- left flower -->
        <g class="flowerGroup" transform="translate(260,220)">
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-38" fill="url(#petalG1)" transform="rotate(0)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-38" fill="url(#petalG1)" transform="rotate(45)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-38" fill="url(#petalG1)" transform="rotate(90)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-38" fill="url(#petalG1)" transform="rotate(135)"/>
          <circle class="center" r="14" fill="url(#centerG)"/>
        </g>

        <!-- middle flower -->
        <g class="flowerGroup" transform="translate(500,180)">
          <ellipse class="petal" rx="56" ry="32" cx="0" cy="-46" fill="url(#petalG2)" transform="rotate(0)"/>
          <ellipse class="petal" rx="56" ry="32" cx="0" cy="-46" fill="url(#petalG2)" transform="rotate(60)"/>
          <ellipse class="petal" rx="56" ry="32" cx="0" cy="-46" fill="url(#petalG2)" transform="rotate(120)"/>
          <circle class="center" r="16" fill="url(#centerG)"/>
        </g>

        <!-- right flower -->
        <g class="flowerGroup" transform="translate(700,230)">
          <ellipse class="petal" rx="44" ry="26" cx="0" cy="-36" fill="url(#petalG1)" transform="rotate(0)"/>
          <ellipse class="petal" rx="44" ry="26" cx="0" cy="-36" fill="url(#petalG1)" transform="rotate(72)"/>
          <ellipse class="petal" rx="44" ry="26" cx="0" cy="-36" fill="url(#petalG1)" transform="rotate(144)"/>
          <circle class="center" r="12" fill="url(#centerG)"/>
        </g>

        <!-- small bloom -->
        <g class="flowerGroup" transform="translate(420,140)">
          <ellipse class="petal" rx="30" ry="18" cx="0" cy="-28" fill="url(#petalG2)" transform="rotate(0)"/>
          <ellipse class="petal" rx="30" ry="18" cx="0" cy="-28" fill="url(#petalG2)" transform="rotate(72)"/>
          <circle class="center" r="9" fill="url(#centerG)"/>
        </g>
      </g>

      <text x="500" y="680" text-anchor="middle" fill="#6b7280" font-size="18">A little bouquet for you</text>
    </svg>

    <div class="hearts-container" id="hearts"></div>
  </div>

  <div class="panel">
    <div>
      <h1>For</h1>
      <div class="recipient" id="recipient">Evan</div>
      <p class="lead">Soft romantic flowers, a little surprise. Click a flower to reveal the message and release a shower of hearts.</p>
    </div>

    <div class="controls">
      <button class="btn secondary small" id="revealAll">Surprise Now</button>
      <button class="btn secondary small" id="downloadBtn" style="margin-left:auto">Download as image</button>
    </div>

    <div style="margin-top:12px;font-size:13px;color:#7b6b77">Tip: Click any flower for the surprise. Use Download to save a PNG of the bouquet.</div>
  </div>
</div>

<!-- Surprise overlay -->
<div class="overlay" id="overlay" aria-hidden="true">
  <div class="card" role="dialog" aria-modal="true" aria-labelledby="surpriseTitle">
    <h2 id="surpriseTitle">For Evan ‚Äî A Surprise</h2>
    <p id="surpriseText">Roses are lovely, violets are true ‚Äî every moment sparkles more with you. Will you be my Valentine?</p>
    <button class="closeBtn" id="closeOverlay">Close & Return</button>
    <div class="credit" style="margin-top:12px;color:#856f7b;font-size:13px">Made with ‚ù§Ô∏è</div>
  </div>
</div>

<script>
/* Keep the dynamic behavior, but flowers will now show as static fallback if JS can't create them */
const recipientName = "Evan";
document.getElementById('recipient').textContent = recipientName;
document.getElementById('surpriseText').textContent = "Roses are lovely, violets are true ‚Äî every moment sparkles more with you. Will you be my Valentine?";

const overlay = document.getElementById('overlay');
const closeOverlay = document.getElementById('closeOverlay');
const revealAllBtn = document.getElementById('revealAll');
const heartsContainer = document.getElementById('hearts');

function spawnHearts(cx, cy, count=8){
  for(let i=0;i<count;i++){
    const el = document.createElement('div');
    el.className = 'heart';
    el.style.left = (cx - 14 + (Math.random()*80-40)) + 'px';
    el.style.top = (cy - 14 + (Math.random()*40-20)) + 'px';
    el.style.fontSize = (14 + Math.random()*18) + 'px';
    el.textContent = ['‚ù§','üíó','üíï'][Math.floor(Math.random()*3)];
    el.style.animationDelay = (Math.random()*0.25)+'s';
    heartsContainer.appendChild(el);
    setTimeout(()=> el.remove(), 2600 + Math.random()*900);
  }
}

document.getElementById('floralSVG').addEventListener('click', (ev)=>{
  // if user clicks near a flower area, show surprise; approximate hit by bounding boxes
  const rect = ev.target.getBoundingClientRect ? ev.target.getBoundingClientRect() : {left:ev.clientX, top:ev.clientY};
  // Use click position relative to SVG
  const svg = document.getElementById('floralSVG');
  const pt = svg.createSVGPoint(); pt.x = ev.clientX; pt.y = ev.clientY;
  const ctm = svg.getScreenCTM(); // might be null in some viewers
  let x = ev.clientX, y = ev.clientY;
  try { const inv = ctm.inverse(); const loc = pt.matrixTransform(inv); x = loc.x; y = loc.y; } catch(e){}
  // show overlay and hearts at click position
  overlay.classList.add('show'); overlay.setAttribute('aria-hidden','false');
  spawnHearts(x, y, 8);
});

// reveal all button
revealAllBtn.addEventListener('click', ()=>{
  overlay.classList.add('show'); overlay.setAttribute('aria-hidden','false');
  const points = [{x:420,y:200},{x:540,y:180},{x:500,y:260},{x:600,y:220}];
  points.forEach(pt=>spawnHearts(pt.x, pt.y, 8));
});
closeOverlay.addEventListener('click', ()=> { overlay.classList.remove('show'); overlay.setAttribute('aria-hidden','true'); });
document.getElementById('downloadBtn').addEventListener('click', async ()=>{
  const svg = document.getElementById('floralSVG');
  const serializer = new XMLSerializer();
  const svgStr = serializer.serializeToString(svg);
  const blob = new Blob([svgStr], {type:'image/svg+xml;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  try {
    const img = new Image(); img.crossOrigin='anonymous'; img.src=url;
    await new Promise((res,rej)=>{ img.onload=res; img.onerror=rej; });
    const canvas = document.createElement('canvas'); canvas.width=1200; canvas.height=840;
    const ctx = canvas.getContext('2d'); ctx.fillStyle='#fff'; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
    const data = canvas.toDataURL('image/png'); const a = document.createElement('a'); a.href=data; a.download=`valentine_for_${recipientName}.png`; document.body.appendChild(a); a.click(); a.remove();
  } catch(e){ alert('Sorry ‚Äî couldn\\'t create image in this browser.'); } finally { URL.revokeObjectURL(url); }
});
document.addEventListener('keydown',(ev)=>{ if(ev.key==='Escape') overlay.classList.remove('show'); });
console.log('Static fallback loaded for', recipientName);
</script>
</body>
</html>

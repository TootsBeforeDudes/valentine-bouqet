<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>For Evan â€” Fixed-size roses</title>
<style>
  :root{--bg:#fff6f8;--accent:#d63384;--shadow: rgba(10,10,20,0.08)}
  html,body{height:100%;margin:0;background:var(--bg);display:flex;align-items:center;justify-content:center;font-family:Inter,system-ui,Arial;}
  .wrap{width:760px; padding:18px; box-sizing:border-box}
  .card{width:700px;height:720px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff6f8);box-shadow:0 18px 40px var(--shadow);display:flex;flex-direction:column;align-items:center;padding:18px}
  h1{margin:8px 0 0 0;font-size:18px;color:#3a2b33}
  .name{color:var(--accent);font-size:28px;font-weight:700;margin:6px 0}
  .hint{color:#6b7280;text-align:center;margin:6px 0}
  button{margin-top:10px;padding:10px 14px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:#fff;cursor:pointer}
  /* fixed-size SVG, centered and stable */
  svg{display:block; margin:8px auto 0 auto; width:700px; height:520px; border-radius:6px}
  svg *{ transform-box:fill-box; transform-origin:center; }
  .petal{filter:drop-shadow(0 6px 10px rgba(0,0,0,0.06)); transition:transform 260ms ease}
  .flower:hover .petal{ transform:scale(1.03) }
  .stem{stroke:#2b6b3a; stroke-width:5; stroke-linecap:round; fill:none}
  .flower{ cursor:pointer }
  .svg-bubble{ transform-origin:center bottom; opacity:0; transition:transform .22s, opacity .22s }
  .svg-bubble.show{ transform:translateY(-6px) scale(1); opacity:1 }
  .heart{ position:fixed; pointer-events:none; z-index:1100 }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main">
      <!-- fixed-size SVG: viewBox matches drawn coordinates (0..700 x 0..520) -->
      <svg id="svg" viewBox="0 0 700 520" xmlns="http://www.w3.org/2000/svg" aria-label="Fixed roses">
        <defs>
          <radialGradient id="p1" cx="30%" cy="30%"><stop offset="0%" stop-color="#ffdfe6"/><stop offset="60%" stop-color="#ff7f9a"/><stop offset="100%" stop-color="#d64b6d"/></radialGradient>
          <radialGradient id="p2" cx="30%" cy="30%"><stop offset="0%" stop-color="#fff1e6"/><stop offset="60%" stop-color="#ff9aa6"/><stop offset="100%" stop-color="#d45b78"/></radialGradient>
          <radialGradient id="cG" cx="40%" cy="40%"><stop offset="0%" stop-color="#fff8d8"/><stop offset="100%" stop-color="#ffd166"/></radialGradient>
          <linearGradient id="vG" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stop-color="#fff"/><stop offset="100%" stop-color="#ffeef6"/></linearGradient>
        </defs>

        <!-- vase placed near bottom center of 700x520 -->
        <g transform="translate(350,420)">
          <ellipse cx="0" cy="30" rx="150" ry="22" fill="rgba(0,0,0,0.06)"/>
          <path d="M-120 8 C-90 120 90 120 120 8 L100 180 C50 210 -50 210 -100 180 Z" fill="url(#vG)"/>
        </g>

        <!-- LEFT flower group at (170,200) -->
        <g class="flower" transform="translate(170,200)" data-name="left">
          <circle class="hit" cx="0" cy="0" r="70" fill="transparent" style="pointer-events:all"/>
          <!-- adjusted so final point drops into vase -->
          <path class="stem" d="M0 6 C -8 80 -10 220 120 260"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(-48)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p2)" transform="rotate(12)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(72)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p2)" transform="rotate(132)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(192)"/>
          <circle cx="0" cy="-8" r="8" fill="url(#cG)"/>
        </g>

        <!-- CENTER flower group at (350,170) -->
        <g class="flower" transform="translate(350,170)" data-name="center">
          <circle class="hit" cx="0" cy="0" r="90" fill="transparent" style="pointer-events:all"/>
          <!-- adjusted so final point drops into vase -->
          <path class="stem" d="M0 10 C -6 120 -14 240 0 300"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-36" fill="url(#p2)" transform="rotate(-48)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-36" fill="url(#p1)" transform="rotate(12)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-36" fill="url(#p2)" transform="rotate(72)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-36" fill="url(#p1)" transform="rotate(132)"/>
          <ellipse class="petal" rx="48" ry="28" cx="0" cy="-36" fill="url(#p2)" transform="rotate(192)"/>
          <circle cx="0" cy="-10" r="12" fill="url(#cG)"/>
        </g>

        <!-- RIGHT flower group at (530,200) -->
        <g class="flower" transform="translate(530,200)" data-name="right">
          <circle class="hit" cx="0" cy="0" r="70" fill="transparent" style="pointer-events:all"/>
          <!-- adjusted so final point drops into vase -->
          <path class="stem" d="M0 6 C -6 80 -30 220 -120 260"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(-48)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p2)" transform="rotate(12)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(72)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p2)" transform="rotate(132)"/>
          <ellipse class="petal" rx="36" ry="20" cx="0" cy="-28" fill="url(#p1)" transform="rotate(192)"/>
          <circle cx="0" cy="-8" r="8" fill="url(#cG)"/>
        </g>

        <!-- SVG single-line bubble (hidden until shown) anchored in this SVG -->
        <g id="bubble" class="svg-bubble hide" transform="translate(350,60)" opacity="0">
          <rect x="-220" y="-36" rx="12" ry="12" width="440" height="42" fill="#fff" stroke="rgba(0,0,0,0.04)"/>
          <path d="M-18 -2 L0 22 L18 -2 Z" fill="#fff" stroke="rgba(0,0,0,0.03)"/>
          <text id="bubbleText" x="0" y="-12" font-family="Inter,Arial" font-size="16" fill="#35272f" text-anchor="middle">Evan â€” will you be my Valentine?</text>
          <g id="bubbleClose" transform="translate(0,8)" style="cursor:pointer"><rect x="-36" y="0" rx="8" ry="8" width="72" height="26" fill="#d63384"/><text x="0" y="18" font-family="Inter,Arial" font-size="13" fill="#fff" text-anchor="middle">Close</text></g>
        </g>
      </svg>

      <h1>For</h1>
      <div class="name" id="recipient">Evan</div>
      <p class="hint">Click any rose and the message will appear from that rose.</p>
      <button id="surprise" >Surprise Now</button>
    </div>
  </div>

<script>
  // Robust interaction for fixed-size SVG
  const svg = document.getElementById('svg');
  const bubble = document.getElementById('bubble');
  const bubbleText = document.getElementById('bubbleText');
  const bubbleClose = document.getElementById('bubbleClose');
  const recipient = "Evan";
  document.getElementById('recipient').textContent = recipient;
  const singleLine = `${recipient} â€” will you be my Valentine?`;

  // safe conversion helpers
  function clientToSvg(clientX, clientY){
    const pt = svg.createSVGPoint();
    pt.x = clientX; pt.y = clientY;
    const ctm = svg.getScreenCTM();
    if(!ctm) return {x:clientX,y:clientY};
    return pt.matrixTransform(ctm.inverse());
  }
  function svgToClient(sx, sy){
    const pt = svg.createSVGPoint(); pt.x = sx; pt.y = sy;
    const ctm = svg.getScreenCTM();
    return pt.matrixTransform(ctm);
  }

  // show bubble at svg point
  function showBubbleAtSvg(sx, sy, text){
    bubbleText.textContent = text;
    bubble.setAttribute('transform', `translate(${sx}, ${sy - 90})`);
    bubble.classList.add('show'); bubble.classList.remove('hide'); bubble.setAttribute('opacity','1');
  }
  function hideBubble(){ bubble.classList.remove('show'); bubble.classList.add('hide'); bubble.setAttribute('opacity','0'); }

  // spawn hearts from svg point
  function spawnHearts(sx, sy, count=10){
    const client = svgToClient(sx, sy);
    for(let i=0;i<count;i++){
      const el = document.createElement('div');
      el.className = 'heart';
      el.textContent = ['â¤','ðŸ’—','ðŸ’•'][Math.floor(Math.random()*3)];
      document.body.appendChild(el);
      const size = 12 + Math.random()*26; el.style.fontSize = size + 'px';
      const left = client.x + (Math.random()*80 - 40); const top = client.y + (Math.random()*30 - 8);
      el.style.left = left + 'px'; el.style.top = top + 'px';
      const dx = (Math.random()*120 - 60); const dy = -(120 + Math.random()*80);
      el.animate([{transform:'translate(0,0) scale(1)', opacity:1},{transform:`translate(${dx}px,${dy}px) scale(.85)`, opacity:0}], {duration:1400 + Math.random()*800, easing:'cubic-bezier(.2,.9,.3,1)'});
      setTimeout(()=> el.remove(), 1800 + Math.random()*900);
    }
  }

  // attach to hit circles
  svg.querySelectorAll('.hit').forEach(hit => {
    hit.addEventListener('click', (ev) => {
      ev.stopPropagation(); ev.preventDefault();
      const group = hit.parentNode;
      const rect = group.getBoundingClientRect();
      const clientX = rect.left + rect.width/2;
      const clientY = rect.top + rect.height/2;
      const svgPt = clientToSvg(clientX, clientY);
      showBubbleAtSvg(svgPt.x, svgPt.y, singleLine);
      spawnHearts(svgPt.x, svgPt.y, 12);
    }, {passive:false});
  });

  // Surprise button: center flower
  document.getElementById('surprise').addEventListener('click', ()=>{
    const centerG = svg.querySelector('[data-name="center"]');
    const rect = centerG.getBoundingClientRect();
    const svgPt = clientToSvg(rect.left + rect.width/2, rect.top + rect.height/2);
    showBubbleAtSvg(svgPt.x, svgPt.y, singleLine);
    spawnHearts(svgPt.x, svgPt.y, 12);
  });

  // close bubble
  bubbleClose.addEventListener('click', (ev)=>{ ev.stopPropagation(); hideBubble(); });

  // clicking outside hides bubble
  document.body.addEventListener('click', (ev)=>{
    if(ev.target.closest && ev.target.closest('#bubble')) return;
    hideBubble();
  });

  // ESC closes
  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') hideBubble(); });

  hideBubble();
</script>
</body>
</html>
